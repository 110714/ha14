/*
 * jquery.zeroclipboard
 * https://github.com/zeroclipboard/jquery.zeroclipboard
 *
 * Copyright (c) 2014 James M. Greene
 * Licensed under the MIT license.
 */
!function(a,b){"use strict";function h(){for(var a,c="",d={},e=b.getSelection(),f=document.createElement("div"),g=0,h=e.rangeCount;h>g;g++)a=e.getRangeAt(g),c+=a.toString(),f.appendChild(a.cloneContents());return d["text/plain"]=c,c.replace(/\s/g,"")&&(d["text/html"]=f.innerHTML),d}function i(a){if("string"!=typeof a||!a)return null;var b,c,d=a;return d=d.replace(/<(?:hr)(?:\s+[^>]*)?\s*[\/]?>/gi,"{\\pard \\brdrb \\brdrs \\brdrw10 \\brsp20 \\par}\n{\\pard\\par}\n"),d=d.replace(/<(?:br)(?:\s+[^>]*)?\s*[\/]?>/gi,"{\\pard\\par}\n"),d=d.replace(/<(?:p|div|section|article)(?:\s+[^>]*)?\s*[\/]>/gi,"{\\pard\\par}\n"),d=d.replace(/<(?:[^>]+)\/>/g,""),d=d.replace(/<a(?:\s+[^>]*)?(?:\s+href=(["'])(?:javascript:void\(0?\);?|#|return false;?|void\(0?\);?|)\1)(?:\s+[^>]*)?>/gi,"{{{\n"),b=d,d=d.replace(/<a(?:\s+[^>]*)?(?:\s+href=(["'])(.+)\1)(?:\s+[^>]*)?>/gi,'{\\field{\\*\\fldinst{HYPERLINK\n "$2"\n}}{\\fldrslt{\\ul\\cf1\n'),c=d!==b,d=d.replace(/<a(?:\s+[^>]*)?>/gi,"{{{\n"),d=d.replace(/<\/a(?:\s+[^>]*)?>/gi,"\n}}}"),d=d.replace(/<(?:b|strong)(?:\s+[^>]*)?>/gi,"{\\b\n"),d=d.replace(/<(?:i|em)(?:\s+[^>]*)?>/gi,"{\\i\n"),d=d.replace(/<(?:u|ins)(?:\s+[^>]*)?>/gi,"{\\ul\n"),d=d.replace(/<(?:strike|del)(?:\s+[^>]*)?>/gi,"{\\strike\n"),d=d.replace(/<sup(?:\s+[^>]*)?>/gi,"{\\super\n"),d=d.replace(/<sub(?:\s+[^>]*)?>/gi,"{\\sub\n"),d=d.replace(/<(?:p|div|section|article)(?:\s+[^>]*)?>/gi,"{\\pard\n"),d=d.replace(/<\/(?:p|div|section|article)(?:\s+[^>]*)?>/gi,"\n\\par}\n"),d=d.replace(/<\/(?:b|strong|i|em|u|ins|strike|del|sup|sub)(?:\s+[^>]*)?>/gi,"\n}"),d=d.replace(/<(?:[^>]+)>/g,""),d="{\\rtf1\\ansi\n"+(c?"{\\colortbl\n;\n\\red0\\green0\\blue255;\n}\n":"")+d+"\n}"}function j(b){var c=a.Event(b.type,a.extend(b,{_source:"swf"}));if(a(b.target).trigger(c),"copy"===c.type){if(a.event.special.copy.options.requirePreventDefault===!0&&!c.isDefaultPrevented()){b.clipboardData.clearData();var d=h();(d["text/plain"]||d["text/html"])&&b.clipboardData.setData(d)}var e=f.getData();if(a.event.special.copy.options.autoConvertHtmlToRtf===!0&&e["text/html"]&&!e["application/rtf"]){var g=i(e["text/html"]);b.clipboardData.setData("application/rtf",g)}}}function k(b){var c=a.Event("copy-error",a.extend(b,{type:"copy-error",_source:"swf"}));a(b.target).trigger(c)}function l(){a.event.props.push("clipboardData"),f.config(a.extend(!0,{autoActivate:!1},q.options)),f.on("beforecopy copy aftercopy",j),f.on("error",k),f.create()}function m(){f.destroy();var b=a.event.props.indexOf("clipboardData");-1!==b&&a.event.props.splice(b,1)}function n(b){p(b),b.target&&b.target!==f.activeElement()&&b.target!==a("#"+f.config("containerId"))[0]&&b.target!==a("#"+f.config("swfObjectId"))[0]&&f.focus(b.target)}function o(b){p(b),b.relatedTarget&&b.relatedTarget!==f.activeElement()&&b.relatedTarget!==a("#"+f.config("containerId"))[0]&&b.relatedTarget!==a("#"+f.config("swfObjectId"))[0]&&f.blur()}function p(a){f.isFlashUnusable()||"js"===a.originalEvent._source||(a.stopImmediatePropagation(),a.preventDefault())}var d=0,e=".zeroclipboard",f=b.ZeroClipboard,g=f.config("trustedDomains"),q={add:function(b){0===d++&&l();var c=e+(b.namespace?"."+b.namespace:""),f=b.selector,g="zc|{"+f+"}|{"+c+"}|count",h=a(this);"number"!=typeof h.data(g)&&h.data(g,0),0===h.data(g)&&(h.on("mouseenter"+c,f,n),h.on("mouseleave"+c,f,o),h.on("mouseover"+c,f,p),h.on("mouseout"+c,f,p),h.on("mousemove"+c,f,p),h.on("mousedown"+c,f,p),h.on("mouseup"+c,f,p),h.on("click"+c,f,p)),h.data(g,h.data(g)+1)},remove:function(b){var c=e+(b.namespace?"."+b.namespace:""),f=b.selector,g="zc|{"+f+"}|{"+c+"}|count",h=a(this);h.data(g,h.data(g)-1),0===h.data(g)&&(h.off("click"+c,f,p),h.off("mouseup"+c,f,p),h.off("mousedown"+c,f,p),h.off("mousemove"+c,f,p),h.off("mouseout"+c,f,p),h.off("mouseover"+c,f,p),h.off("mouseleave"+c,f,o),h.off("mouseenter"+c,f,n),h.removeData(g)),0===--d&&m()},trigger:function(b){if("copy"===b.type){var c=a(this),d="swf"===b._source;delete b._source,d||(c.trigger(a.extend(!0,{},b,{type:"beforecopy"})),c.one("copy",function(){var d={},e=f.getData();a.each(e,function(a){d[a]=!1});var g=a.extend(!0,{},b,{type:"aftercopy",data:a.extend(!0,{},e),success:d});c.trigger(g)}))}},_default:function(){return!0},options:{requirePreventDefault:!0,autoConvertHtmlToRtf:!0,trustedDomains:g,hoverClass:"hover",activeClass:"active"}};a.event.special.beforecopy=q,a.event.special.copy=q,a.event.special.aftercopy=q,a.event.special["copy-error"]=q}(jQuery,function(){return this||window}());